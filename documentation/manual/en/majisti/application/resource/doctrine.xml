<?xml version="1.0" encoding="UTF-8"?>
<section xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" xml:lang="en"
    xml:id="majisti.application.resource.doctrine" version="5.0">
    <title>Doctrine</title>
    
    <para>The doctrine resource will configure and provide a Doctrine2
        EntityManager . The database settings must be set in order for this
        resource to work. Make sure to check out Zend's documentation on how to
        configure the Db Resource. Configuration of the doctrine resource is
        very straightforward. Based on the official documentation, the resource
        will make sure that:<itemizedlist>
            <listitem>
                <para>Caching is enabled for Entities.</para>
            </listitem>
            <listitem>
                <para>Metadata cache is enabled.</para>
            </listitem>
            <listitem>
                <para>Query cache implementation.</para>
            </listitem>
            <listitem>
                <para>A <classname>DriverChain</classname> is used for mapping
                    drivers.</para>
            </listitem>
            <listitem>
                <para>Proxy namespace, directories and classes are used.</para>
            </listitem>
            <listitem>
                <para>An EventManager is instancied and passed to the
                    EntityManager</para>
            </listitem>
        </itemizedlist></para>
    <para>Based on the official <link
            xlink:href="http://www.doctrine-project.org/docs/orm/2.0/en/reference/configuration.html"
            >documentation</link> Majisti provides a default setup for the
        Doctrine resource:</para>
    <variablelist>
        <varlistentry>
            <term>DriverChain</term>
            <listitem>
                <para>The driver chain is used for multiple mapping drivers.
                    Majisti automatically adds an Annotation driver for each
                    modules found within the application (excluding fallback
                    directories) and one for the application's library. That
                    means that you can expect your models to generate a database
                    schema on your sql backend when using the CliLoader that
                    reflects those models. Extensions use that driver chain to
                    add more drivers to the stack.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Proxies</term>
            <listitem>
                <para>Proxy classes are generated within
                    ${majisti.app.path}/application/doctrine/proxies under
                    {$majisti.app.namespace}\Doctrine\Proxies. Those are
                    autogenerated under development and not under
                    production.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Fixtures</term>
            <listitem>
                <para>The Doctrine2 Data fixtures extension was also added to
                    Majisti. Those are also added for every module and the
                    application's library.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Caching</term>
            <listitem>
                <para>Following the environment, the Doctrine resource switches
                    caching depending on the environment. By default, it uses
                    the ArrayCache for development and <acronym>APC</acronym>
                    for production.</para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>SQL Drivers</term>
            <listitem>
                <para>When no SQL driver is specified for the Doctrine resource,
                    it takes the same database driver name as Zend's Db
                    Resource, meaning that using the <code>pdo_mysql</code>
                    adapter will use the <code>pdo_mysql</code> doctrine
                    driver.</para>
            </listitem>
        </varlistentry>
    </variablelist>
    <note>
        <para>The resource is currently not configurable. An extensive
            configuration based on the official <link
                xlink:href="http://www.doctrine-project.org/docs/orm/2.0/en/reference/configuration.html"
                >documentation</link> will be provided in future
            versions.</para>
    </note>
</section>
